- content_for :footer do
  javascript:

    $('a#update_item').click(function(){
      //$(this).attr('checked',true);
      // if ($(this).is(':checked')) {
        $('div#form').slideUp('fast');
        $('div#update').slideDown('fast')
        $('div.new div#action').show();
        var setname = $(this).attr('id'), elements = {};
        $(this).parents('tr').find('td.change').each(function(e){
          var setname = $(this).attr('id')
          elements[setname] = $(this).text();
        })
        $('form input.change').each(function(index, item){
          $(this).val((elements[$(item).attr('id')]))
        })
        var product_id = #{@product.id}
        var variant_id = $(this).parents('td').find('input#variant_id').val();
        $(this).parents('tr').find('input#option_value_id').each(function(n, item){
          var id = $(item).val();
          $('input#variant_options_attributes_'+n+'_id').val(id)
        })
        url = "/admin/products/"+product_id+"/variants/"+variant_id
        $('form#edit_variant').attr('action', url)
        //} else{
        //  $('div#update').slideUp('slow')
        //}
      })
      $('input#new_variant').click(function(){
        $('div.new div#action').hide();
        $('div#form').slideDown('fast');
        $('div#update').slideUp('fast')
      })
      $('.error').parents('div.hide').show();
      if ($('.error').parents('div.hide').attr('id') == 'form'){
        $('div.new div#action').hide();
      }

- content_for :breadcrumb do
  == breadcrumb([{ 'Home' => admin_dashboard_path }, { 'Configuration' => url_for(:controller => :themes) }, { 'Themes' => url_for(:controller => :themes) }])

= render "imentore/admin/products/top"

.tab#variants
  table.table.table-bordered.table-striped
    thead
      tr
        th.minimal #
        th sku
        - @product.options.each do |op|
          th= "options: " + op.name
        th price
        th quantity
        th weight
        th Action
    tbody
      - @product.variants.each do |variant|
        - unless variant.id.nil?
          tr
            td
              = hidden_field_tag(:variant_id, variant.id, :class=>'change', :id =>'variant_id')
              / = check_box_tag "check_box"
              / '
              = variant.id
            td.change(id='sku')
              a(href='#' id='update_item')
                = variant.sku
            - variant.options.each_with_index do |ov, index|
              td.change(id=ov.option_type.name)= ov.value
              = hidden_field_tag(:option_value_id, ov.id, :class=>'change', :id =>'option_value_id')
            td.change#price= variant.price
            td.change#quantity= variant.quantity
            td.change#weight= variant.weight
            td
              a(href='#' id='update_item')
                = "Edit"
              '
              '|
              '
              = link_to("Images", new_admin_product_variant_image_path(@product, variant))

/ = simple_form_for([:admin, @product], :html => {:class => 'form-horizontal'}) do |f|
/   = f.simple_fields_for(:variants) do |v|
/     = v.input :price
/     = v.input :quantity
/     = v.input :weight
/     = v.simple_fields_for :options do |of|
/       = of.input :value, label: of.object.option_type.name
/   .form-actions
/     = f.submit(:class => "btn-primary")
#update.hide
  - variant_update = @product.variants.first
  = simple_form_for variant_update, as: "variant", url: admin_product_variant_path(@product, variant_update), :html => {:class => 'form-horizontal', method: :put} do |f|
    = f.error_notification
    = f.input :sku, input_html: { :class => 'change', :id => 'sku'}
    = f.simple_fields_for :options do |of|
      = of.input :option_type_id, as: :hidden, input_html: { :value => of.object.option_type_id }
      = of.input :value, label: of.object.option_type.name, input_html: { :class => 'change', :id => of.object.option_type.name}
    = f.input :price, input_html: { :class => 'change', :id => 'price'}
    = f.input :quantity, input_html: { :class => 'change', :id => 'quantity'}
    = f.input :weight, input_html: { :class => 'change', :id => 'weight'}
    .form-actions
      = f.button :submit, :class => "btn-primary"

.new
  #action
    = text_field_tag "new_variant", 'New Variant', :class=>'btn btn-primary', :type=> "submit"
  #form.hide
    - if @variant.nil?
      - @variant ||= @product.variants.build
      - @product.options.each do |option_type|
        - @variant.options.build(option_type: option_type, product_variant: @variant)
    = simple_form_for @variant, as: "variant", url: admin_product_variants_path(@product), :html => {:class => 'form-horizontal'}, input_html: { method: :post } do |f|
      = f.error_notification
      = f.input :sku
      = f.simple_fields_for :options do |of|
        = of.input :option_type_id, as: :hidden, input_html: { :value => of.object.option_type_id }
        = of.input :value, label: of.object.option_type.name
      = f.input :price
      = f.input :quantity
      = f.input :weight
      .form-actions
        = f.button :submit, :class => "btn-primary"